<!DOCTYPE html>
<html>
  <head>
    <title>R and Visualizations – Quick Plots – Timo Wager – Yet Another Data Something Blog.</title>

        <meta charset="utf-8" />
    <meta content='text/html; charset=utf-8' http-equiv='Content-Type'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1.0'>

    
    <meta name="description" content="In this post, I wanna talk about how you can make quick visualizations  with R. This series will be continued with advanced plotting using the neat R package ggplot2 or interactive graphics with plotly. But at first let’s start with some quick and dirty techniques to get a first glance at your data. As you know, every data analysis should start with summaries of exploratory statistics and most important a holistic glimpse into your data set. Let’s face it, human are visual living beings.

" />
    <meta property="og:description" content="In this post, I wanna talk about how you can make quick visualizations  with R. This series will be continued with advanced plotting using the neat R package ggplot2 or interactive graphics with plotly. But at first let’s start with some quick and dirty techniques to get a first glance at your data. As you know, every data analysis should start with summaries of exploratory statistics and most important a holistic glimpse into your data set. Let’s face it, human are visual living beings.

" />
    
    <meta name="author" content="Timo Wager" />

    
    <meta property="og:title" content="R and Visualizations – Quick Plots" />
    <meta property="twitter:title" content="R and Visualizations – Quick Plots" />
    

    <!--[if lt IE 9]>
      <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="alternate" type="application/rss+xml" title="Timo Wager - Yet Another Data Something Blog." href="/feed.xml" />

    <!-- Created with Jekyll Now - http://github.com/barryclark/jekyll-now -->
  </head>

  <body>
    <div class="wrapper-masthead">
      <div class="container">
        <header class="masthead clearfix">
          <a href="/" class="site-avatar"><img src="https://avatars2.githubusercontent.com/u/26152358?v=3&u=3ce04d6d58ef6f11be830f4b1c59ce2db97cfec2&s=400" /></a>

          <div class="site-info">
            <h1 class="site-name"><a href="/">Timo Wager</a></h1>
            <p class="site-description">Yet Another Data Something Blog.</p>
          </div>

          <nav>
            <a href="/">Blog</a>
            <a href="/about">About</a>
          </nav>
        </header>
      </div>
    </div>

    <div id="main" role="main" class="container">
      <article class="post">
  <h1>R and Visualizations – Quick Plots</h1>

  <div class="entry">
    <p>In this post, I wanna talk about how you can make quick visualizations  with R. This series will be continued with advanced plotting using the neat R package <code class="highlighter-rouge">ggplot2</code> or interactive graphics with <code class="highlighter-rouge">plotly</code>. But at first let’s start with some quick and dirty techniques to get a first glance at your data. As you know, every data analysis should start with summaries of exploratory statistics and most important a holistic glimpse into your data set. Let’s face it, human are visual living beings.</p>

<p>I will briefly capture the basic graphic types:</p>

<ul>
  <li><em>Scatter Plots</em></li>
  <li><em>Line Graphs</em></li>
  <li><em>Bar Graphs</em></li>
  <li><em>Histograms</em></li>
  <li><em>Box Plots</em></li>
  <li><em>Function Curves</em></li>
</ul>

<h3 id="scatter-plot">Scatter Plot</h3>

<p>Let’ start with a simple scatter plot. The sample data set we will use for the demonstrations is the build in <em>Motor Trend Car Road Tests</em> (<code class="highlighter-rouge">mtcars</code>) data set. Use the <code class="highlighter-rouge">str()</code> command to get to know the structure of the <code class="highlighter-rouge">data.frame</code>. As you see we have 11 numerical variables.</p>

<div class="language-R highlighter-rouge"><pre class="highlight"><code><span class="n">str</span><span class="p">(</span><span class="n">mtcars</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>'data.frame':	32 obs. of  11 variables:
 $ mpg : num  21 21 22.8 21.4 18.7 18.1 14.3 24.4 22.8 19.2 ...
 $ cyl : num  6 6 4 6 8 6 8 4 4 6 ...
 $ disp: num  160 160 108 258 360 ...
 $ hp  : num  110 110 93 110 175 105 245 62 95 123 ...
 $ drat: num  3.9 3.9 3.85 3.08 3.15 2.76 3.21 3.69 3.92 3.92 ...
 $ wt  : num  2.62 2.88 2.32 3.21 3.44 ...
 $ qsec: num  16.5 17 18.6 19.4 17 ...
 $ vs  : num  0 0 1 1 0 1 0 1 1 1 ...
 $ am  : num  1 1 1 0 0 0 0 0 0 0 ...
 $ gear: num  4 4 4 3 3 3 3 4 4 4 ...
 $ carb: num  4 4 1 1 2 1 4 2 2 4 ...
</code></pre>
</div>

<p>So let’s quickly plot the weights <code class="highlighter-rouge">wt</code> against the gasoline consumption <code class="highlighter-rouge">mpg</code> (miles per gallon)</p>

<div class="language-R highlighter-rouge"><pre class="highlight"><code><span class="n">plot</span><span class="p">(</span><span class="n">mtcars</span><span class="o">$</span><span class="n">wt</span><span class="p">,</span><span class="w"> </span><span class="n">mtcars</span><span class="o">$</span><span class="n">mpg</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<p><img src="../images/R_and_Visualizations_Quick_Plots_files/R_and_Visualizations_Quick_Plots_5_0.png" alt="png" /></p>

<p>As expected, we can see a clear negative correlation. The heavier the car the less miles per gallon are driven, hence the gasoline consumption for a given distance rises.</p>

<p>We now use the <code class="highlighter-rouge">ggplot2</code> package. If you don’t have it installed yet, call <code class="highlighter-rouge">install.packages("ggplot2")</code>.
Now we can activate the library and use its quick plot function <code class="highlighter-rouge">qplot()</code> to get the similiar result but in a nicer format.</p>

<div class="language-R highlighter-rouge"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span><span class="w">
</span><span class="n">qplot</span><span class="p">(</span><span class="n">mtcars</span><span class="o">$</span><span class="n">wt</span><span class="p">,</span><span class="w"> </span><span class="n">mtcars</span><span class="o">$</span><span class="n">mpg</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<p><img src="../images/R_and_Visualizations_Quick_Plots_files/R_and_Visualizations_Quick_Plots_7_1.png" alt="png" /></p>

<p>Looks cool right? … And if your two variables are in the same data set you can leave out the <code class="highlighter-rouge">$</code> declaration and call <code class="highlighter-rouge">qplot(wt, mpg, data = mtcars)</code></p>

<blockquote>
  <p>Note that for both approaches the variables for the <code class="highlighter-rouge">x axis</code> is the first parameter, followed by the <code class="highlighter-rouge">y axis</code></p>
</blockquote>

<p>I will go more in depth with the individual plotting function <code class="highlighter-rouge">ggplot()</code> in later blog posts of this series. So let’s move forward to line graphs.</p>

<h2 id="line-graph">Line Graph</h2>

<p>For this demonstrations the build in <code class="highlighter-rouge">pressure</code> data set suits perfectly. Let’s have a look…</p>

<div class="language-R highlighter-rouge"><pre class="highlight"><code><span class="n">str</span><span class="p">(</span><span class="n">pressure</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>'data.frame':	19 obs. of  2 variables:
 $ temperature: num  0 20 40 60 80 100 120 140 160 180 ...
 $ pressure   : num  0.0002 0.0012 0.006 0.03 0.09 0.27 0.75 1.85 4.2 8.8 ...
</code></pre>
</div>

<p>Ok… so why not check out the relationship between temperature and pressure. To declare a line graph for the base <code class="highlighter-rouge">plot()</code> function declare its <code class="highlighter-rouge">type</code> parameter with <code class="highlighter-rouge">"l"</code></p>

<div class="language-R highlighter-rouge"><pre class="highlight"><code><span class="n">plot</span><span class="p">(</span><span class="n">pressure</span><span class="o">$</span><span class="n">temperature</span><span class="p">,</span><span class="w"> </span><span class="n">pressure</span><span class="o">$</span><span class="n">pressure</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="s2">"l"</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<p><img src="../images/R_and_Visualizations_Quick_Plots_files/R_and_Visualizations_Quick_Plots_13_0.png" alt="png" /></p>

<p>If we want to modify the line, you can simply call e.g. <code class="highlighter-rouge">points()</code> in the next line with the same data to add points to the lines. When you want to display other line graphs in the same plot, just call <code class="highlighter-rouge">lines()</code>. To distinguish between the two lines, use the <code class="highlighter-rouge">col</code> parameter to define the color.</p>

<div class="language-R highlighter-rouge"><pre class="highlight"><code><span class="n">plot</span><span class="p">(</span><span class="n">pressure</span><span class="o">$</span><span class="n">temperature</span><span class="p">,</span><span class="w"> </span><span class="n">pressure</span><span class="o">$</span><span class="n">pressure</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="s2">"l"</span><span class="p">)</span><span class="w">
</span><span class="c1"># add points to the line graph
</span><span class="n">points</span><span class="p">(</span><span class="n">pressure</span><span class="o">$</span><span class="n">temperature</span><span class="p">,</span><span class="w"> </span><span class="n">pressure</span><span class="o">$</span><span class="n">pressure</span><span class="p">)</span><span class="w">
</span><span class="c1"># add another line graph with points to the current plot. Use a red color
</span><span class="n">lines</span><span class="p">(</span><span class="n">pressure</span><span class="o">$</span><span class="n">temperature</span><span class="p">,</span><span class="w"> </span><span class="n">pressure</span><span class="o">$</span><span class="n">pressure</span><span class="o">/</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="s2">"blue"</span><span class="p">)</span><span class="w">
</span><span class="n">points</span><span class="p">(</span><span class="n">pressure</span><span class="o">$</span><span class="n">temperature</span><span class="p">,</span><span class="w"> </span><span class="n">pressure</span><span class="o">$</span><span class="n">pressure</span><span class="o">/</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="s2">"blue"</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<p><img src="../images/R_and_Visualizations_Quick_Plots_files/R_and_Visualizations_Quick_Plots_15_0.png" alt="png" /></p>

<p>Now let’s look again at the <code class="highlighter-rouge">qplot()</code> function of the <code class="highlighter-rouge">ggplot2</code> library.</p>

<div class="language-R highlighter-rouge"><pre class="highlight"><code><span class="n">qplot</span><span class="p">(</span><span class="n">temperature</span><span class="p">,</span><span class="w"> </span><span class="n">pressure</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">pressure</span><span class="p">,</span><span class="w"> </span><span class="n">geom</span><span class="o">=</span><span class="s2">"line"</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<p><img src="../images/R_and_Visualizations_Quick_Plots_files/R_and_Visualizations_Quick_Plots_17_1.png" alt="png" /></p>

<p>Like in the case of the base <code class="highlighter-rouge">plot()</code> function you can simply add modification options or other lines.</p>

<div class="language-R highlighter-rouge"><pre class="highlight"><code><span class="n">qplot</span><span class="p">(</span><span class="n">temperature</span><span class="p">,</span><span class="w"> </span><span class="n">pressure</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">pressure</span><span class="p">,</span><span class="w"> </span><span class="n">geom</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s2">"line"</span><span class="p">,</span><span class="w"> </span><span class="s2">"point"</span><span class="p">),</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"a"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
</span><span class="c1"># Add a second line with points to the plot. Use the group parameter color for differentiation. This sets colors autom.
</span><span class="n">geom_line</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">temperature</span><span class="p">,</span><span class="w"> </span><span class="n">pressure</span><span class="o">/</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"b"</span><span class="p">),</span><span class="w"> </span><span class="n">pressure</span><span class="p">)</span><span class="o">+</span><span class="w">
</span><span class="n">geom_point</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">temperature</span><span class="p">,</span><span class="w"> </span><span class="n">pressure</span><span class="o">/</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"b"</span><span class="p">),</span><span class="w"> </span><span class="n">pressure</span><span class="p">)</span><span class="w"> </span><span class="c1">#+ scale_color_manual(values=c("black", "blue"))
</span></code></pre>
</div>

<p><img src="../images/R_and_Visualizations_Quick_Plots_files/R_and_Visualizations_Quick_Plots_19_1.png" alt="png" /></p>

<p>To add another line to the quick plot of <code class="highlighter-rouge">ggplot2</code>, you have to use the plus sign <code class="highlighter-rouge">+</code>. This is a common procedure, also for the <code class="highlighter-rouge">ggplot()</code> function. You basically add other options, lines etc. to the active plot. The <code class="highlighter-rouge">aes</code> parameter builds the aesthetic mappings and describe how variables in the data are mapped to visual properties (aesthetics) of <code class="highlighter-rouge">geoms</code> (geometric forms: lines, points etc.). The arguments for <code class="highlighter-rouge">aes</code> are the <code class="highlighter-rouge">x</code> and <code class="highlighter-rouge">y</code> axis. Optionally you can set a <code class="highlighter-rouge">color</code> parameter for differentiation.</p>

<blockquote>
  <p>Note that the <code class="highlighter-rouge">color</code> argument in the <code class="highlighter-rouge">qplot()</code> function is not equivilent to the <code class="highlighter-rouge">col</code> argument in the base <code class="highlighter-rouge">plot()</code> function. <code class="highlighter-rouge">Color</code> is a group parameter and sets automatically the colors. If you want to determine the used colors in the plot manually you have also to add <code class="highlighter-rouge">scale_color_manual()</code> to the plot function. You will see that in another post.</p>
</blockquote>

<h2 id="bar-graph">Bar Graph</h2>

<p>To make a bar chart you can use the base function <code class="highlighter-rouge">barplot()</code> and pass it a vector of values for the height of each bar and (optionally) a vector of labels for each bar (<code class="highlighter-rouge">names.arg</code> parameter).</p>

<p>Let us investigate the build in data <code class="highlighter-rouge">BOD</code>. We have a discrete <code class="highlighter-rouge">Time</code> variable and continous values for the biochemical oxygen <code class="highlighter-rouge">demand</code>.</p>

<div class="language-R highlighter-rouge"><pre class="highlight"><code><span class="n">str</span><span class="p">(</span><span class="n">BOD</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>'data.frame':	6 obs. of  2 variables:
 $ Time  : num  1 2 3 4 5 7
 $ demand: num  8.3 10.3 19 16 15.6 19.8
</code></pre>
</div>

<div class="language-R highlighter-rouge"><pre class="highlight"><code><span class="c1"># without names.arg=BOD$Time the x axis would not have labels
</span><span class="n">barplot</span><span class="p">(</span><span class="n">BOD</span><span class="o">$</span><span class="n">demand</span><span class="p">,</span><span class="w"> </span><span class="n">names.arg</span><span class="o">=</span><span class="n">BOD</span><span class="o">$</span><span class="n">Time</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<p><img src="../images/R_and_Visualizations_Quick_Plots_files/R_and_Visualizations_Quick_Plots_23_0.png" alt="png" /></p>

<p>For every discrete Timestamp the demand value is plotted. Sometimes the <code class="highlighter-rouge">y axis</code> (or bars) shows the discrete counts for each category on the <code class="highlighter-rouge">x axis</code>. This is similar to a histogram, but with a discrete instead of continuous <code class="highlighter-rouge">x axis</code>. To generate the count of each unique value in a vector, call the <code class="highlighter-rouge">table()</code> function.</p>

<div class="language-R highlighter-rouge"><pre class="highlight"><code><span class="n">table</span><span class="p">(</span><span class="n">mtcars</span><span class="o">$</span><span class="n">cyl</span><span class="p">)</span><span class="w">
</span><span class="c1"># There are 11 cases with 4 cylinders, 7 cases of 6, and 14 cases of 8
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code> 4  6  8
11  7 14
</code></pre>
</div>

<p>Now you can easily use the <code class="highlighter-rouge">barplot()</code> function to generate a visualization out of that information.</p>

<div class="language-R highlighter-rouge"><pre class="highlight"><code><span class="c1"># Generate a table of cylinder counts
</span><span class="n">barplot</span><span class="p">(</span><span class="n">table</span><span class="p">(</span><span class="n">mtcars</span><span class="o">$</span><span class="n">cyl</span><span class="p">))</span><span class="w">
</span></code></pre>
</div>

<p><img src="../images/R_and_Visualizations_Quick_Plots_files/R_and_Visualizations_Quick_Plots_27_0.png" alt="png" /></p>

<p>In <code class="highlighter-rouge">ggplot2</code> you can use the <code class="highlighter-rouge">qplot()</code> function for a fast way to show a count-based bar chart. Notice the difference between a continous and a discrete <code class="highlighter-rouge">x axis</code>. Call the <code class="highlighter-rouge">factor()</code> method to discretize the <code class="highlighter-rouge">x</code> values.</p>

<div class="language-R highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="c1"># cyl is continuous here
</span><span class="n">qplot</span><span class="p">(</span><span class="n">mtcars</span><span class="o">$</span><span class="n">cyl</span><span class="p">)</span><span class="w">
</span><span class="c1"># Treat cyl as discrete
</span><span class="n">qplot</span><span class="p">(</span><span class="n">factor</span><span class="p">(</span><span class="n">mtcars</span><span class="o">$</span><span class="n">cyl</span><span class="p">))</span><span class="w">
</span></code></pre>
</div>

<p><img src="../images/R_and_Visualizations_Quick_Plots_files/R_and_Visualizations_Quick_Plots_29_3.png" alt="png" /></p>

<p><img src="../images/R_and_Visualizations_Quick_Plots_files/R_and_Visualizations_Quick_Plots_29_4.png" alt="png" /></p>

<h2 id="histogram">Histogram</h2>

<p>Now we will view the distribution of one-dimensional data with a histogram. Let’s see how the gasoline consumption of the cars in the <code class="highlighter-rouge">mtcars</code> data set is distributed.</p>

<div class="language-R highlighter-rouge"><pre class="highlight"><code><span class="n">hist</span><span class="p">(</span><span class="n">mtcars</span><span class="o">$</span><span class="n">mpg</span><span class="p">)</span><span class="w">
</span><span class="c1"># Specify approximate number of bins with breaks
</span><span class="n">hist</span><span class="p">(</span><span class="n">mtcars</span><span class="o">$</span><span class="n">mpg</span><span class="p">,</span><span class="w"> </span><span class="n">breaks</span><span class="o">=</span><span class="m">10</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<p><img src="../images/R_and_Visualizations_Quick_Plots_files/R_and_Visualizations_Quick_Plots_31_0.png" alt="png" /></p>

<p><img src="../images/R_and_Visualizations_Quick_Plots_files/R_and_Visualizations_Quick_Plots_31_1.png" alt="png" /></p>

<p>The chart at the bottom has more bins. Notice that because the bins are narrower, there are fewer items in each bin.</p>

<p>With the <code class="highlighter-rouge">ggplot2</code> package you can get a similar result using <code class="highlighter-rouge">qplot()</code>.</p>

<div class="language-R highlighter-rouge"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span><span class="w">

</span><span class="c1"># default bin width
</span><span class="n">qplot</span><span class="p">(</span><span class="n">mtcars</span><span class="o">$</span><span class="n">mpg</span><span class="p">)</span><span class="w">
</span><span class="c1"># with wider bins
</span><span class="n">qplot</span><span class="p">(</span><span class="n">mpg</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">mtcars</span><span class="p">,</span><span class="w"> </span><span class="n">binwidth</span><span class="o">=</span><span class="m">4</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<p><img src="../images/R_and_Visualizations_Quick_Plots_files/R_and_Visualizations_Quick_Plots_33_3.png" alt="png" /></p>

<p><img src="../images/R_and_Visualizations_Quick_Plots_files/R_and_Visualizations_Quick_Plots_33_4.png" alt="png" /></p>

<h2 id="box-plots">Box Plots</h2>

<p>Now it is time to focus on Box plots. It is a helpful tool to compare distributions. Therfore, let’s dive into the effect of vitamin C on tooth growth in guinea pigs.</p>

<div class="language-R highlighter-rouge"><pre class="highlight"><code><span class="n">str</span><span class="p">(</span><span class="n">ToothGrowth</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>'data.frame':	60 obs. of  3 variables:
 $ len : num  4.2 11.5 7.3 5.8 6.4 10 11.2 11.2 5.2 7 ...
 $ supp: Factor w/ 2 levels "OJ","VC": 2 2 2 2 2 2 2 2 2 2 ...
 $ dose: num  0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 ...
</code></pre>
</div>

<p>We want to compare the tooth length of the two supplement types (<code class="highlighter-rouge">VC</code> or <code class="highlighter-rouge">OJ</code>). So we can look at the box plots. The base <code class="highlighter-rouge">plot()</code>function will automatically create a box plot when <code class="highlighter-rouge">x</code> is a factor. So pass it a factor of x values and a vector of y values. Here, <code class="highlighter-rouge">supp</code> is a factor value with two levels <code class="highlighter-rouge">VC</code> and <code class="highlighter-rouge">OJ</code>, where <code class="highlighter-rouge">y</code> is the numerical length value.</p>

<div class="language-R highlighter-rouge"><pre class="highlight"><code><span class="n">plot</span><span class="p">(</span><span class="n">ToothGrowth</span><span class="o">$</span><span class="n">supp</span><span class="p">,</span><span class="w"> </span><span class="n">ToothGrowth</span><span class="o">$</span><span class="n">len</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<p><img src="../images/R_and_Visualizations_Quick_Plots_files/R_and_Visualizations_Quick_Plots_37_0.png" alt="png" /></p>

<p>As we can see, the group of guinea pigs which got the orange juice (<code class="highlighter-rouge">OJ</code>) have a higher median and quartiles as well as the spread of lengths is narrower.</p>

<p>If the two vectors are in the same data frame, you can also use the <em>formula syntax</em> (a typical <code class="highlighter-rouge">R</code> procedure as seen in other functions). With this syntax, you can also combine two variables on the <code class="highlighter-rouge">x axis</code>. We can see then how the <code class="highlighter-rouge">dose</code> variable (0.5, 1, and 2 mg/day) interacts with the supplement group (<code class="highlighter-rouge">OJ</code> or <code class="highlighter-rouge">VC</code>).</p>

<div class="language-R highlighter-rouge"><pre class="highlight"><code><span class="c1"># Formula syntax
</span><span class="n">boxplot</span><span class="p">(</span><span class="n">len</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">supp</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ToothGrowth</span><span class="p">)</span><span class="w">
</span><span class="c1"># Put interaction of two variables on x axis
</span><span class="n">boxplot</span><span class="p">(</span><span class="n">len</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">supp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">dose</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ToothGrowth</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<p><img src="../images/R_and_Visualizations_Quick_Plots_files/R_and_Visualizations_Quick_Plots_39_0.png" alt="png" /></p>

<p><img src="../images/R_and_Visualizations_Quick_Plots_files/R_and_Visualizations_Quick_Plots_39_1.png" alt="png" /></p>

<p>Not surprisingly, as the dose of vitamine C rises the tooth length does too. And with 2 mg/day the medians of the two supplement groups are the same. But the <code class="highlighter-rouge">VC</code> group has more variance. The lowest variance (except of one outlier) is achieved with 1 mg/day of ascorbic acid (a form of vitamin C and coded as <code class="highlighter-rouge">VC</code>).</p>

<p>As you should already guess, slightly* the same results can be achieved with <code class="highlighter-rouge">qplot()</code> (* Read the note section at the end). You only have to declare the <code class="highlighter-rouge">geom</code> parameter as <code class="highlighter-rouge">"boxplot"</code>. To combine more variables, you have to use the <code class="highlighter-rouge">interaction()</code> function as <code class="highlighter-rouge">x</code> variable; formula syntax is not allowed.</p>

<div class="language-R highlighter-rouge"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span><span class="w">

</span><span class="n">qplot</span><span class="p">(</span><span class="n">ToothGrowth</span><span class="o">$</span><span class="n">supp</span><span class="p">,</span><span class="w"> </span><span class="n">ToothGrowth</span><span class="o">$</span><span class="n">len</span><span class="p">,</span><span class="w"> </span><span class="n">geom</span><span class="o">=</span><span class="s2">"boxplot"</span><span class="p">)</span><span class="w">
</span><span class="c1"># Using three separate vectors
</span><span class="n">qplot</span><span class="p">(</span><span class="n">interaction</span><span class="p">(</span><span class="n">ToothGrowth</span><span class="o">$</span><span class="n">supp</span><span class="p">,</span><span class="w"> </span><span class="n">ToothGrowth</span><span class="o">$</span><span class="n">dose</span><span class="p">),</span><span class="w"> </span><span class="n">ToothGrowth</span><span class="o">$</span><span class="n">len</span><span class="p">,</span><span class="n">geom</span><span class="o">=</span><span class="s2">"boxplot"</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<p><img src="../images/R_and_Visualizations_Quick_Plots_files/R_and_Visualizations_Quick_Plots_41_2.png" alt="png" /></p>

<p><img src="../images/R_and_Visualizations_Quick_Plots_files/R_and_Visualizations_Quick_Plots_41_3.png" alt="png" /></p>

<blockquote>
  <p>You may noticed that the box plots from the base graphics are slightly different from <code class="highlighter-rouge">ggplot2</code>. This is because they use different methods for calculating quantiles. See <code class="highlighter-rouge">?geom_boxplot</code> and <code class="highlighter-rouge">?boxplot.stats</code> for more information.</p>
</blockquote>

<h2 id="function-curves">Function Curves</h2>

<p>If you want to plot a function use <code class="highlighter-rouge">curve()</code> and pass it an expression with the variable x. Define the <code class="highlighter-rouge">from</code> and <code class="highlighter-rouge">to</code> arguments to set the domain.</p>

<div class="language-R highlighter-rouge"><pre class="highlight"><code><span class="n">curve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="m">3</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m">5</span><span class="o">*</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">from</span><span class="o">=</span><span class="m">-4</span><span class="p">,</span><span class="w"> </span><span class="n">to</span><span class="o">=</span><span class="m">4</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<p><img src="../images/R_and_Visualizations_Quick_Plots_files/R_and_Visualizations_Quick_Plots_44_0.png" alt="png" /></p>

<p>You can also define your own function. It just has to output a numeric vector. Using <code class="highlighter-rouge">add = TRUE</code> will add a curve to the previously created plot. We will show this by plotting the inverse function.</p>

<div class="language-R highlighter-rouge"><pre class="highlight"><code><span class="c1"># Plot a user-defined function
</span><span class="n">myfun</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">xvar</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="m">1</span><span class="o">/</span><span class="p">(</span><span class="m">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="o">-</span><span class="n">xvar</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">10</span><span class="p">))</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="n">curve</span><span class="p">(</span><span class="n">myfun</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="w"> </span><span class="n">from</span><span class="o">=</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">to</span><span class="o">=</span><span class="m">20</span><span class="p">)</span><span class="w">
</span><span class="c1"># Add a line:
</span><span class="n">curve</span><span class="p">(</span><span class="m">1</span><span class="o">-</span><span class="n">myfun</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="w"> </span><span class="n">add</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"red"</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<p><img src="../images/R_and_Visualizations_Quick_Plots_files/R_and_Visualizations_Quick_Plots_46_0.png" alt="png" /></p>

<p>For the <code class="highlighter-rouge">ggplot2</code> package equivilent, one used <code class="highlighter-rouge">qplot(c(0,2), fun=myfun, stat="function", geom="line")</code> But now <code class="highlighter-rouge">stat</code> is deprecated in 2016 and <code class="highlighter-rouge">fun</code> is no longer an acceptable parameter.</p>

<p>To get similar results with the <code class="highlighter-rouge">ggplot2</code> package you now have to use the <code class="highlighter-rouge">ggplot()</code> method and call the <code class="highlighter-rouge">stat_function()</code> with parameter <code class="highlighter-rouge">fun</code>. The domain input has to be defined as a <code class="highlighter-rouge">data.frame</code></p>

<div class="language-R highlighter-rouge"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span><span class="w">

</span><span class="c1"># Plot a user-defined function
</span><span class="n">myfun</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">xvar</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="m">1</span><span class="o">/</span><span class="p">(</span><span class="m">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="o">-</span><span class="n">xvar</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">10</span><span class="p">))</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="n">ggplot</span><span class="p">(</span><span class="n">data.frame</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">20</span><span class="p">)),</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
</span><span class="n">stat_function</span><span class="p">(</span><span class="n">fun</span><span class="o">=</span><span class="n">myfun</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<p><img src="../images/R_and_Visualizations_Quick_Plots_files/R_and_Visualizations_Quick_Plots_48_1.png" alt="png" /></p>

<p>So now you should have a basic understanding to plot some quick graphs to get a first look into your data. I will try to continue this series with more detailed explanations on how to use the <code class="highlighter-rouge">ggplot2</code> package with the <code class="highlighter-rouge">ggplot()</code> function since this is more powerful for making expressive charts.</p>

  </div>

  <div class="date">
    Written on May  5, 2017
  </div>

  
<div class="comments">
	<div id="disqus_thread"></div>
	<script type="text/javascript">

	    var disqus_shortname = '{"shortname"=>"https-wagnertimo-github-io"}';

	    (function() {
	        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
	        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
	        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	    })();

	</script>
	<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>


</article>

    </div>

    <div class="wrapper-footer">
      <div class="container">
        <footer class="footer">
          
<a href="mailto:wagnertimo@gmx.de"><i class="svg-icon email"></i></a>


<a href="https://github.com/wagnertimo"><i class="svg-icon github"></i></a>

<a href="https://www.linkedin.com/in/timo-wagner-95168213a/"><i class="svg-icon linkedin"></i></a>






        </footer>
      </div>
    </div>

    

  </body>
</html>
